/------------------/
HARDWARE PREPARATION:
/------------------/

Instruction on testing bare packetONE boards.

To communicate with packetONE, a USB-UAR Converter is needed.
At the back of the packetONE board, there are pads at the back that needs to be connected to USBtoUART bridge:

When using trigger input for remote mode, ensure to have a pullup or pulldown resistor to define the state of the pin.

PacketONE ----- USBtoUART

VCC -> 3.3V
RX -> TX
TX -> RX
BOOT0 -
GROUND - GND

/------------------/
TERMINAL SOFTWARE PREPARATION:
/------------------/

Baud rate: 115200
Data bits: 8
Stop bits: 1
Parity: None
Flow control: None

Trasmissted text: Append Nothing (NO CR or LF)

/------------------/
SERIAL COMMANDS TO CHECK IF S76S IS WORKING:
/------------------/

Initial Codes to check functionality of S76S

sip get_ver
	// Check version
>> v1.6.1

sip factory_reset	// Reset

>> v1.6.1

mac get_deveui		// Check Deveui

>> 9c65f9fffe1a88fd

mac get_ch_para 0	// Check frequency settings of 8 channels	

>> 868100000 0 6 1 0

mac get_ch_para 1

>> 868300000 0 6 1 0

mac get_ch_para 2

>> 868500000 0 6 1 0

mac get_ch_para 3

>> 867100000 0 6 0 0

mac get_ch_para 4

>> 867300000 0 6 0 0

mac get_ch_para 5

>> 867500000 0 6 0 0

mac get_ch_para 6

>> 867700000 0 6 0 0

mac get_ch_para 7

>> 867900000 0 6 0 0


/------------------/
Before proceeding. Setup application console in TTN.
/------------------/

/------------------/
ACSIP COMMAND TO SETUP REMOTE MODE FOR SENDING TEMPERATURE
/------------------/

Temperatur sensor is connected to PA0

STEP 1:
Check version, reset S67S then get deveui.

sip get_ver
	// Check version
>> v1.6.1

sip factory_reset	// Reset

>> v1.6.1

mac get_deveui		// Check Deveui

>> 9c65f9fffe1a88fd


STEP 2:
Copy the set appeui and appkey from TTN application console

mac set_appeui 70B3D57ED000AD7F

>> Ok

mac set_appkey A14768CB2A52073C56541E1A5CCBC0A0

>> Ok	 

STEP 3: 
Connect via OTAA and send unconfirmed message.

mac join otaa

>> Ok


>> accepted


mac tx ucnf 15 1234
  // 15 is port number and 1234 is payload
>> Ok



>> tx_ok

STEP 4:
Setup OTAA tries attempt and Automatic Joining when reset then save.

mac set_auto_join on otaa 3

>> Ok


mac save

>> Ok

STEP 5:
Setup channels for Remote Mode. Enable (set_adc 0)PA0 and (set_adc 1)PB0.

rm set_adc 0 on

>> Ok


rm set_adc 1 on

>> Ok


rm set_adc_switch on

>> Ok


rm set_port_uplink 200
		// use port 200
>> Ok

STEP 6:
Setup transmission cycle mode.

rm set_mode cycle

>> Ok


mac set_tx_mode cycle

>> Ok


mac set_tx_confirm off

>> Ok

mac set_tx_interval 6000

>> Ok

mac join otaa
>> Ok

mac save   //ensure to save!
>> Ok

// Unit needs to reset(connect disconnect power) to start sending adc data. Else, it will start FF FF FF FF.

/------------------/
ACSIP COMMAND TO SETUP ABP MODE FOR SINGLE BUTTON
/------------------/

STEP 1:
Check version, reset S67S then get deveui.

sip get_ver
	// Check version
>> v1.6.1

sip factory_reset	// Reset

>> v1.6.1

mac get_deveui		// Check Deveui

>> 9c65f9fffe1a88fd

STEP 2:
Register the device in TTN by using the deveui.
Go to setting and select ABP as activation method to generate updated NSKeys and AppSkeys.
Update the dev addr, network session keys and app session keys.

// Set following according to LoRaWAN configuration
mac set_devaddr 00220009 //replace number with your own devaddr.
>> Ok
mac set_nwkskey 965F6942F29C9EBE5747E25F07DA5114 //replace nwkskey with the one generated by TTN.
>> Ok
mac set_appskey A46847D184323C21C992D8F9EF4B7CE9 //replace nwkskey with the one generated by TTN.
>> Ok

mac set_tx_confirm off

>> Ok

STEP 3:
Activate via ABP and test sending of msg.
// Activation by Personalization
mac join abp
>> Ok
>> accepted
// Send unconfirmed uplink on port 15
mac tx ucnf 15 1234
>> Ok
>> tx_ok

STEP 4:
Setup auto Join and save.

mac set_auto_join on abp
>> Ok
(Don’t forget to save the last setting above, or it would not take effect after reboot)
mac save
>> Ok

STEP 5:
Reset and see abp activation.

sip reset

     ___        _____ _ ____ 
    /   | _____/ ___/(_) __ \
   / /| |/ ___/\__ \/ / /_/ / Tech Co., LTD
  / ___ / /__ ___/ / / ____/   LoRaWAN v1.0.2 Ready
 /_/  |_\___//____/_/_/         (Class A & C)

>> S76S - v1.6.1 - EU868 - Oct 20 2017 - 16:10:41 


>> join by abp

>> Ok

>> accepted

STEP 6: Setup Remote mode for 1 input button C8.

rm set_gpio in 0 NC // Do not to use GPIO IN0
>> Ok

rm set_gpio in 1 C 8 // Use C8 as GPIO input.
>> Ok

rm set_gpio_switch on // Enable GPIO1 in Report Mode
>> Ok

rm set_adc 0 off // Not to use ADC Channel 0 (Fixed at PA_0) and Channel 1 (PB_0)
>> Ok

rm set_adc 1 off
>> Ok

rm set_adc_switch off // Disable ADC
>> Ok

rm set_port_uplink 150 // Use port 150 as uplink port.
>> Ok


STEP 7: 

rm set_trigger B 0 both  // setup PB0 as trigger on all mode (both = falling or rising edge)
>> Ok

rm set_mode trigger 
>> Ok

mac set_tx_mode no_cycle 
>> Ok

mac join abp
>> accepted

mac save
>> ok

EXTRA NOTE:
Tested the instructions above to use PB0 which is the ADC1 channel of remote mode. It works as a digital trigger pin.
rm set_trigger B 0 both 